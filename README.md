# Binary Studio Academy 2019

## Домашнее задание #4

### Требования

Это задание направлено на проектировние архитектуры приложения с использованием принципов ООП и паттернов проектирования. В частности затрагивается обработка команд и ошибок, управление состоянием и жизненным циклом объектов, геймификация.

***

### Установка

Установка показана в рабочем окружении OS Linux:

```bash
git clone https://github.com/BinaryStudioAcademy/bsa-2019-php-4.git
cd bsa-2019-php-4
composer install
```
Мы рекомендум использовать Homestead.

### Задание
Вам необходимо разработать консольную игру "Pirates". 

Вы играете за пиратов (`PirateShip`) против королевского флота (`RoyalShip`).

Корабль имеет такие свойства:

```php
int strength // определяет наносимый урон (1 до 10)
int armour   // защиту к урону (1 - 10)
int luck     // определяет удачу попадания (1-10)
int health   // здоровье корабля (1 - 100)
array hold   // трюм корабля для добычи, вместительность: 3 элемента добычи.
```

У корабля должны быть команды:

```php
/**
 * @param int $direction - константа направления
 * 
 * Плыть в следующую гавань в заданном направлении
 */
public function setSails(int $direction);

/**
 * Выстрелить в корабль.
 */
public function fire();

/**
 * @param Ship $ship - побежденный корабль
 * 
 * Взять корабль на абордаж и собрать добычу с побежденного корабля. Добыча складывается в трюм корабля
 */
public function aboard(Ship $ship);
```

С побежденного корабля можно собрать сундук золота (`ChestGold`) или ром (`Rum`). Золото можно обменять на один из статов (силу, защиту или удачу), а за ром поднять здоровье на 30 единиц.

В игровом мире должно быть 8 гаваней:

- 1 пиратская гавань без вражеских кораблей, где начинается игра. Здесь же можно обменять сундуки с золотом.

- 4 гавани с патрульными шхунами (`Schooner`) с низкими статами:
    > strength: 2-5 <br />
    > armour: 2-5 <br />
    > luck: 1-5 <br />
    > health: 50

- 2 гавани с боевым флотом ее величества (`BattleShip`) со средними статами:
    > strength: 4-8 <br />
    > armour: 4-8 <br />
    > luck: 4-7 <br />
    > health: 80

- И 1 гавань с королевским фрегатом ее величества (`HerMajestyShipRoyalSovereign`) с самыми высокими статами:
    > strength: 10 <br />
    > armour: 10 <br />
    > luck: 10 <br />
    > health: 100

Возвращаться в каждую гавань разрешается неограниченное количество раз, и каждый раз там должен генерироваться новый корабль соответствующий гавани.

Если игрок проигрывает, то он возвращается в пиратскую гавань и с него снимается 10 единиц здоровья, и по одному стату от текущих.

Задача игры потопить королевский фрегат, после чего игра считается завершенной.

#### Команды игры:

- `help` - выводит список команд

- `stats` - выводит статы корабля и содержимое трюма

- `start` - начать игру. Игра начинается в гавани пиратов. Корабль изначально должен иметь низкие статы:

    > strength: 4 <br />
    > armour: 4 <br />
    > luck: 4 <br />
    > health: 60

- `set-sail <east|west|north|south>` - плыть в следующую гавань. Попав в гавань первый ход за игроком. Во время сражения также можно переплывать между гаванями.

- `fire` - выстрелить в корабль. Сражение происходит пошагово, сперва стреляет игрок, затем NPC. Вероятность попадания должна зависеть от удачи корабля. А нанесенный урон от силы и защиты.

- `aboard` - собрать добычу с побежденного корабля. 

- `buy <strength|armour|luck>` - купить 1 стат. Покупать статы можно только в пиратской гавани за сундуки с золотом.

- `drink` - выпить бутылку рома. Выпить ром считается за действие, т.е. нельзя выпить ром и атаковать. Или приплыть в королевскую гавань выпить ром и уплыть. После выпитого рома следующий шаг за вражеским кораблем.

- `exit` - завершить игру

Карта локаций и возможных перемещений:

![map](Map.png)

#### Режимы игры

```php
/**
 * Запускает игру в цикле и опрашивает пользовательский ввод.
 */
public function start(Reader $reader, Writer $writer);

/**
 * Пошаговое выполнение.
 * Запускает игру и выполняет только одну команду с $reader'a.
 * Этот режим необходим для тестирования.
 */
public function run(Reader $reader, Writer $writer);
```

### Проверка

- Игра должна запускаться через терминал и исполнять комманды через пользовательский ввод в соответствии с условиями задания.

```bash
php game.php
```

- Проверить себя можно с помощью юнит тестов:

```bash
./vendor/bin/phpunit
```

### Прием решений

Необходимо склонировать этот репозиторий и разместить свое решение на Bitbucket.

__Форкать репозиторий запрещено!__

Оцениваться решение будет по следующим критериям:

1) Игра работает в соответствии с заданием: 6 баллов (будьте внимательны, тесты могут покрывать не все случаи)

2) Использовано минимум [3-и паттерна проектирования](https://designpatternsphp.readthedocs.io/en/latest/): 3 балла

3) Код написан чисто и аккуратно в соответствии со стандартом [PSR-2](https://www.php-fig.org/psr/psr-2/), без комментариев в коде, без функций отладки: 1 балл

